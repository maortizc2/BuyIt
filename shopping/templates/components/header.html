<header
  class="flex flex-wrap items-center justify-between bg-white p-4 shadow gap-4"
>
  <!-- Logo -->
  <div class="logo">
    <a href="{% url 'home' %}" class="text-2xl font-bold text-sky-600"
      >BuyIt üõçÔ∏è</a
    >
  </div>

  <!-- Barra de b√∫squeda -->
  <form
    action="{% url 'search_products' %}"
    method="get"
    class="flex-grow max-w-md mx-auto flex"
  >
    <input
      type="text"
      name="q"
      placeholder="Buscar productos..."
      required
      class="flex-grow p-2 border border-gray-300 rounded-l-md focus:outline-none"
    />
    <button
      type="submit"
      class="p-2 bg-sky-600 text-white rounded-r-md hover:bg-sky-700"
    >
      Buscar
    </button>
  </form>

  <!-- Men√∫ de usuario (si est√° autenticado) -->
  {% if user.is_authenticated %}
  <div class="relative inline-block text-left">
    <button
      id="user-menu-button"
      class="inline-flex justify-center items-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"
    >
      Men√∫
      <svg
        class="ml-2 h-5 w-5"
        xmlns="http://www.w3.org/2000/svg"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path
          fill-rule="evenodd"
          d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z"
          clip-rule="evenodd"
        />
      </svg>
    </button>
    <div
      id="user-dropdown"
      class="origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 hidden"
    >
      <div class="py-1">
        <a
          href="{% url 'favoritos_view' %}"
          class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
          >Productos Favoritos</a
        >
        <a
          href="{% url 'accounts:logout' %}"
          class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
          >Cerrar Sesi√≥n</a
        >
      </div>
    </div>
  </div>
  {% endif %}
</header>

<script>
  const menuButton = document.getElementById("user-menu-button");
  const dropdown = document.getElementById("user-dropdown");
  if (menuButton) {
    menuButton.addEventListener("click", () => {
      dropdown.classList.toggle("hidden");
    });
    window.addEventListener("click", (e) => {
      if (!menuButton.contains(e.target) && !dropdown.contains(e.target))
        dropdown.classList.add("hidden");
    });
  }
</script>
